site: default
domain: &domain m2.local
gateway: &gateway 192.168.155.254
netmask: &netmask 255.255.255.0
nameservers:
- hostname: *gateway
#  options:

networks:
- name: default  # libvirt's default virtual (NAT) network
  mode: nat
  bridge: virbr0
  domain: example.com
  gateway: 192.168.122.1
  netmask: 255.255.255.0
  network: 192.168.122.0
  dhcp:
    start: 192.168.122.200
    end: 192.168.122.254
    static:
      start: 192.168.122.10
      end: 192.168.122.199

- name: service
  mode: nat
  bridge: virbr5
  domain: *domain
  gateway: *gateway
  netmask: *netmask
  network: 192.168.155.0
  dhcp:
    start: 192.168.155.200
    end: 192.168.155.250
    static:
      start: 192.168.155.10
      end: 192.168.155.199


guests:
  - name: ipa
    description: Red Hat IPA Server
    ipa:
      admin: admin
      password: redhat0971

    templates:
      autoinst:
        src: autoinstall.d/ipa-ks.cfg

    setup_data:
      - src: data/ipa/setup.sh
        dst: setup.sh

    guests:
      - hostname: &ipa_1_hostname ipa-1
        fqdn: &ipa_1_fqdn ipa-1.m2.local
        ip: &ipa_1_ip 192.168.155.17
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:17"
            network: service
            host: *ipa_1_hostname
            fqdn: *ipa_1_fqdn
            ip: *ipa_1_ip

  - name: jboss
    description: JBoss EAP Server
    disks:
      - pool: default
        size: 10

    virtinst:
      ram: 1024
      vcpus: 2

    #rhn:
    #  username: foo@m2.local
    #  password: xyzsecret
    #  activationkeys: xxxxxxxxxxxxxxx
    #  profilename: "jboss-0.example.con_in_thinkpad-x220"

    jboss:
      master: 192.168.155.40
      domain:
        user: admin
        secret:
        plain: redhat
        # python: base64.encodestring('redhat') or sh: echo -n 'redhat' | base64
        base64: cmVkaGF0
        # python: hashlib.md5('admin:ManagementRealm:redhat').hexdigest()
        hash: c06ba95adae374bc766be220fad6cc0a

    templates:
      autoinst:
        src: autoinstall.d/rhel-6-jboss-ks.cfg

    setup_data:
      - src: data/jboss/Makefile
        dst: Makefile
      - src: data/jboss/host-slave-0.xml
        dst: host-slave-0.xml

    guests:
      - description: JBoss Domain Controller
        hostname: &jboss_0_hostname jboss-0
        fqdn: &jboss_0_fqdn jboss-0.m2.local
        ip: &jboss_0_ip 192.168.155.40
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:40"
            network: service
            ip: *jboss_0_ip
            host: *jboss_0_hostname
            fqdn: *jboss_0_fqdn

        jboss:
          is_domain_controller: true
          server_groups:
            - name: group1
            - name: group2

        setup_data:
          - src: data/jboss/Makefile
            dst: Makefile
          - src: data/jboss/domain-0.xml
            dst: domain-0.xml
          - src: data/jboss/host-master-0.xml
            dst: host-master-0.xml
          - src: data/jboss/domain-app-deploy.sh
            dst: domain-app-deploy.sh
            install:
              mode: 755
              dst: /usr/sbin/domain-app-deploy.sh

      - hostname: &jboss_1_hostname jboss-1
        fqdn: &jboss_1_fqdn jboss-1.m2.local
        ip: &jboss_1_ip 192.168.155.41
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:41"
            network: service
            ip: *jboss_1_ip
            host: *jboss_1_hostname
            fqdn: *jboss_1_fqdn

        jboss:
          servers:
            - name: *jboss_1_hostname
              group: group1

      - hostname: &jboss_2_hostname jboss-2
        fqdn: &jboss_2_fqdn jboss-2.m2.local
        ip: &jboss_2_ip 192.168.155.42
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:42"
            network: service
            ip: *jboss_2_ip
            host: *jboss_2_hostname
            fqdn: *jboss_2_fqdn

        jboss:
          servers:
            - name: *jboss_2_hostname
              group: group1

      - hostname: &jboss_3_hostname jboss-3
        fqdn: &jboss_3_fqdn jboss-3.m2.local
        ip: &jboss_3_ip 192.168.155.43
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:43"
            network: service
            ip: *jboss_3_ip
            host: *jboss_3_hostname
            fqdn: *jboss_3_fqdn

        jboss:
          servers:
            - name: *jboss_3_hostname
              group: group2

      - hostname: &jboss_4_hostname jboss-4
        fqdn: &jboss_4_fqdn jboss-4.m2.local
        ip: &jboss_4_ip 192.168.155.44
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:44"
            network: service
            ip: *jboss_4_ip
            host: *jboss_4_hostname
            fqdn: *jboss_4_fqdn

        jboss:
          servers:
            - name: *jboss_4_hostname
              group: group2

  - name: rhds
    description: RH Directory Server
    slapd:
      suffix: "dc=m2,dc=local"

    virtinst:
      ram: 1024

    instal_iso_url: "http://ks/isos/DSRV-9-x86_64-DVD1.iso"

    templates:
      autoinst:
        src: autoinstall.d/rhds-ks.cfg

    setup_data:
      - src: data/rhds/setup.inf
        dst: setup.inf
      - src: data/rhds/Makefile
        dst: Makefile

    guests:
      - hostname: &rhds_1_hostname rhds-1
        fqdn: &rhds_1_fqdn rhds-1.m2.local
        ip: &rhds_1_ip 192.168.155.18
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:18"
            network: service
            ip: *rhds_1_ip
            host: *rhds_1_hostname
            fqdn: *rhds_1_fqdn

  - name: rhel-5-client
    description: Versatile RHEL 5 client systems
    filesystem: ext3
    virtinst:
      location: "http://ks/kstree/rhel/5/8/x86_64/"
      os_variant: rhel5.4

    templates:
      autoinst:
        src: autoinstall.d/rhel-5-min-ks.cfg

    guests:
      - hostname: &rhel_5_client_1_hostname rhel-5-client-1
        fqdn: &rhel_5_client_1_fqdn rhel-5-client-1.m2.local
        ip: &rhel_5_client_1_ip 192.158.155.151
        interfaces:
          - device: eth0
            mac: "52:54:00:05:01:51"
            network: service
            ip: *rhel_5_client_1_ip
            host: *rhel_5_client_1_hostname
            fqdn: *rhel_5_client_1_fqdn

      - hostname: &rhel_5_client_2_hostname rhel-5-client-2
        fqdn: &rhel_5_client_2_fqdn rhel-5-client-2.m2.local
        ip: &rhel_5_client_2_ip 192.158.155.152
        interfaces:
          - device: eth0
            mac: "52:54:00:05:01:52"
            network: service
            ip: *rhel_5_client_2_ip
            host: *rhel_5_client_2_hostname
            fqdn: *rhel_5_client_2_fqdn

  - name: rhel-5-cluster
    description: RHEL 5 Cluster (RHCS) nodes
    filesystem: ext3
    virtinst:
      location: "http://ks/kstree/rhel/5/8/x86_64/"
      os_variant: rhel5.4

    ks_repos:
      - name: "RHEL 5 x86_64 - Cluster"
        baseurl: "http://ks/kstree/rhel/5/8/x86_64/Cluster"

    disks:
      - pool: default
        size: 5
      - pool: default
        vol: rhel-5-cluster-data-1.img
        perms: sh
        size: 1

    cluster:
      nodes:
      - &node1 rhel-5-cluster-default-1
      - &node2 rhel-5-cluster-default-2
      resources:
        ip: 192.168.155.100

    defaultgw: *gateway

    hosts:
      - ip: 192.168.122.101
        hostname: rhel-5-cluster-default-1
      - ip: 192.168.122.102
        hostname: rhel-5-cluster-default-2

    templates:
      autoinst:
        src: autoinstall.d/rhel-5-cluster-ks.cfg

    setup_data:
      - src: data/rhel-5-cluster/cluster.conf
        dst: cluster.conf
      - src: data/rhel-5-cluster/init_qdisk.sh
        dst: init_qdisk.sh

    guests:
      - hostname: &rhel_5_cluster_1_hostname rhel-5-cluster-1
        fqdn: &rhel_5_cluster_1_fqdn rhel-5-cluster-1.m2.local
        ip: &rhel_5_cluster_1_ip 192.168.155.101
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:01"
            network: service
            ip: *rhel_5_cluster_1_ip
            host: *rhel_5_cluster_1_hostname
            fqdn: *rhel_5_cluster_1_fqdn
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:01"
            network: default
            ip: 192.168.122.101
            host: rhel-5-cluster-default-1
            nodns: true

      - hostname: &rhel_5_cluster_2_hostname rhel-5-cluster-2
        fqdn: &rhel_5_cluster_2_fqdn rhel-5-cluster-2.m2.local
        ip: &rhel_5_cluster_2_ip 192.168.155.102
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:02"
            network: service
            ip: *rhel_5_cluster_2_ip
            host: *rhel_5_cluster_2_hostname
            fqdn: *rhel_5_cluster_2_fqdn
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:02"
            network: default
            ip: 192.168.122.102
            host: rhel-5-cluster-default-2
            nodns: true

  - name: rhel-5-mrg-m
    description: RHEL 5 MRG-M nodes
    filesystem: ext3
    virtinst:
      location: "http://ks/kstree/rhel/5/8/x86_64/"
      os_variant: rhel5.4

    ks_repos:
      - name: "RHEL 5 x86_64 - MRG-M"
        baseurl: "http://ks/kstree/rhel-5-mrg-2.1-x86_64"

    services:
      enabled:
        - openais
        - qpidd

    # @see common/00_base.yml:
    openais:
      bindnetaddr: 192.168.155.0

    templates:
      autoinst:
        src: autoinstall.d/rhel-5-mrg-m-ks.cfg

    setup_data:
      - src: data/mrg-m/qpidd_cluster_check.py
        dst: qpidd_cluster_check.py

    guests:
      - hostname: &rhel_5_mrg_m_1_hostname rhel-5-mrg-m-1
        fqdn: &rhel_5_mrg_m_1_fqdn rhel-5-mrg-m-1.m2.local
        ip: &rhel_5_mrg_m_1_ip 192.168.155.71
        interfaces:
          - device: eth0
            network: service
            mac: "52:54:00:05:00:71"
            ip: *rhel_5_mrg_m_1_ip
            host: *rhel_5_mrg_m_1_hostname
            fqdn: *rhel_5_mrg_m_1_fqdn

      - hostname: &rhel_5_mrg_m_2_hostname rhel-5-mrg-m-2
        fqdn: &rhel_5_mrg_m_2_fqdn rhel-5-mrg-m-2.m2.local
        ip: &rhel_5_mrg_m_2_ip 192.168.155.72
        interfaces:
          - device: eth0
            network: service
            mac: "52:54:00:05:00:72"
            ip: *rhel_5_mrg_m_2_ip
            host: *rhel_5_mrg_m_2_hostname
            fqdn: *rhel_5_mrg_m_2_fqdn

  - name: rhel-6-client
    description: Versatile RHEL 6 client systems
    templates:
      autoinst:
        src: autoinstall.d/rhel-6-min-ks.cfg

    guests:
      - hostname: &rhel_6_client_1_hostname rhel-6-client-1
        fqdn: &rhel_6_client_1_fqdn rhel-6-client-1.m2.local
        ip: &rhel_6_client_1_ip 192.168.155.161
        interfaces:
          - device: eth0
            network: service
            mac: "52:54:00:05:01:61"
            ip: *rhel_6_client_1_ip
            host: *rhel_6_client_1_hostname
            fqdn: *rhel_6_client_1_fqdn

  - name: rhel-6-cluster-gfs
    description: RHEL 6 GFS nodes
    ks_repos:
      - name: "RHEL 6 x86_64 - Cluster"
        baseurl: "http://ks/kstree/rhel/6/3/x86_64/HighAvailability"
      - name: "RHEL 6 x86_64 - GFS"
        baseurl: "http://ks/kstree/rhel/6/3/x86_64/ResilientStorage"

    disks:
      - pool: default
        size: 5
      - pool: default
        vol: rhel-6-cluster-gfs-data-1.img
        perms: sh
        size: 1

    cluster:
      name: GFS_CLUSTER
      vol:
        journal:
          size: 64
        vg: gfs-vg-0
        lv: gfs-lv-0
        fs: gfs-fs-0
      nodes:
      - name: &rhel_6_cluster_gfs_node1 rhel-6-cluster-gfs-default-1
        fence_name: rhel-6-cluster-gfs-1
      - name: &rhel_6_cluster_gfs_node2 rhel-6-cluster-gfs-default-2
        fence_name: rhel-6-cluster-gfs-2
      - name: &rhel_6_cluster_gfs_node3 rhel-6-cluster-gfs-default-3
        fence_name: rhel-6-cluster-gfs-3
      resources:
        ip: 192.168.155.120

    defaultgw: 192.168.155.254

    hosts:
      - ip: 192.168.122.113
        hostname: *rhel_6_cluster_gfs_node1
      - ip: 192.168.122.114
        hostname: *rhel_6_cluster_gfs_node2
      - ip: 192.168.122.115
        hostname: *rhel_6_cluster_gfs_node3

    templates:
      autoinst:
        src: autoinstall.d/rhel-6-cluster-gfs-ks.cfg

    setup_data:
      - src: data/rhel-6-cluster-gfs/cluster.conf
        dst: cluster.conf
        install:
          mode: 600
          dst: /etc/cluster/cluster.conf
      - src: data/rhel-6-cluster-gfs/init_gfs.sh
        dst: init_gfs.sh
      - src: data/rhel-6-cluster-gfs/check_cman.sh
        dst: check_cman.sh
      - src: data/rhel-6-cluster-gfs/start_cman.sh
        dst: start_cman.sh
      - src: data/rhel-6-cluster-gfs/start_clvmd.sh
        dst: start_clvmd.sh

    guests:
      - hostname: &rhel_6_cluster_gfs_1_hostname rhel-6-cluster-gfs-1
        fqdn: &rhel_6_cluster_gfs_1_fqdn rhel-6-cluster-gfs-1.m2.local
        ip: &rhel_6_cluster_gfs_1_ip 192.168.155.113
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:13"
            ip: *rhel_6_cluster_gfs_1_ip
            host: *rhel_6_cluster_gfs_1_hostname
            fqdn: *rhel_6_cluster_gfs_1_fqdn
            network: service
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:13"
            ip: 192.168.122.113
            host: *rhel_6_cluster_gfs_node1
            network: default
            nodns: true

        cluster_init: true

      - hostname: &rhel_6_cluster_gfs_2_hostname rhel-6-cluster-gfs-2
        fqdn: &rhel_6_cluster_gfs_2_fqdn rhel-6-cluster-gfs-2.m2.local
        ip: &rhel_6_cluster_gfs_2_ip 192.168.155.114
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:14"
            ip: *rhel_6_cluster_gfs_2_ip
            host: *rhel_6_cluster_gfs_2_hostname
            fqdn: *rhel_6_cluster_gfs_2_fqdn
            network: service
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:14"
            ip: 192.168.122.114
            host: *rhel_6_cluster_gfs_node2
            network: default
            nodns: true

      - hostname: &rhel_6_cluster_gfs_3_hostname rhel-6-cluster-gfs-3
        fqdn: &rhel_6_cluster_gfs_3_fqdn rhel-6-cluster-gfs-3.m2.local
        ip: &rhel_6_cluster_gfs_3_ip 192.168.155.115
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:15"
            ip: *rhel_6_cluster_gfs_3_ip
            host: *rhel_6_cluster_gfs_3_hostname
            fqdn: *rhel_6_cluster_gfs_3_fqdn
            network: service
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:15"
            ip: 192.168.122.115
            host: *rhel_6_cluster_gfs_node3
            network: default
            nodns: true

  - name: rhel-6-cluster
    ks_repos:
      - name: "RHEL 6 x86_64 - Cluster"
        baseurl: "http://ks/kstree/rhel/6/3/x86_64/HighAvailability"

    disks:
      - pool: default
        size: 5
      - pool: default
        vol: rhel-6-cluster-data-1.img
        perms: sh
        size: 1

    cluster:
      nodes:
      - &rhel_6_cluster_node1 rhel-6-cluster-default-1
      - &rhel_6_cluster_node2 rhel-6-cluster-default-2
      resources:
        ip: 192.168.155.110

    defaultgw: *gateway

    hosts:
      - ip: 192.168.122.111
        hostname: *rhel_6_cluster_node1
      - ip: 192.168.122.112
        hostname: *rhel_6_cluster_node2

    templates:
      autoinst:
        src: autoinstall.d/rhel-6-cluster-ks.cfg

    setup_data:
      - src: data/rhel-5-cluster/cluster.conf
        dst: cluster.conf
      - src: data/rhel-5-cluster/init_qdisk.sh
        dst: init_qdisk.sh

    guests:
      - hostname: &rhel_6_cluster_1_hostname rhel-6-cluster-1
        fqdn: &rhel_6_cluster_1_fqdn rhel-6-cluster-1.m2.local
        ip: &rhel_6_cluster_1_ip 192.168.155.111
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:11"
            ip: *rhel_6_cluster_1_ip
            host: *rhel_6_cluster_1_hostname
            fqdn: *rhel_6_cluster_1_fqdn
            network: service
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:11"
            ip: 192.168.122.111
            host: rhel-6-cluster-default-1
            network: default
            nodns: true

      - hostname: &rhel_6_cluster_2_hostname rhel-6-cluster-2
        fqdn: &rhel_6_cluster_2_fqdn rhel-6-cluster-2.m2.local
        ip: &rhel_6_cluster_2_ip 192.168.155.112
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:12"
            ip: *rhel_6_cluster_2_ip
            host: *rhel_6_cluster_2_hostname
            fqdn: *rhel_6_cluster_2_fqdn
            network: service
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:12"
            ip: 192.168.122.112
            host: rhel-6-cluster-default-2
            network: default
            nodns: true

  - name: rhel-6-lvs-rs
    description: RHEL 6 LVS Real server
    lvs:
      virtual_ip: 192.168.155.170
      virtual_ip_mask: 24

    ftp:
      allowed_networks:
      - 192.168.155.0/24

    templates:
      autoinst:
        src: autoinstall.d/rhel-6-lvs-rs-ks.cfg

    setup_data:
      - src: data/lvs-rs/setup_dr.sh
        dst: setup_dr.sh

    lvs:
      device: eth0

    guests:
      - hostname: &rhel_6_lvs_rs_1_hostname rhel-6-lvs-rs-1
        fqdn: &rhel_6_lvs_rs_1_fqdn rhel-6-lvs-rs-1.m2.local
        ip: &rhel_6_lvs_rs_1_ip 192.168.155.181
        interfaces:
          - device: eth0
            mac: "52:54:00:05:01:81"
            ip: *rhel_6_lvs_rs_1_ip
            host: *rhel_6_lvs_rs_1_hostname
            fqdn: *rhel_6_lvs_rs_1_fqdn
            network: service
          - device: eth1
            bootproto: static
            ip: 192.168.122.181
            host: rhel-6-lvs-rs-default-1
            mac: "52:54:00:02:01:81"
            network: default
            nodns: true

        lvs:
          real_ip: *rhel_6_lvs_rs_1_ip

      - hostname: &rhel_6_lvs_rs_2_hostname rhel-6-lvs-rs-2
        fqdn: &rhel_6_lvs_rs_2_fqdn rhel-6-lvs-rs-2.m2.local
        ip: &rhel_6_lvs_rs_2_ip 192.168.155.182
        interfaces:
          - device: eth0
            mac: "52:54:00:05:01:82"
            ip: *rhel_6_lvs_rs_2_ip
            host: *rhel_6_lvs_rs_2_hostname
            fqdn: *rhel_6_lvs_rs_2_fqdn
            network: service
          - device: eth1
            bootproto: static
            ip: 192.168.122.182
            host: rhel-6-lvs-rs-default-2
            mac: "52:54:00:02:01:82"
            network: default
            nodns: true

        lvs:
          real_ip: *rhel_6_lvs_rs_2_ip

  - name: rhel-6-lvs
    ks_repos:
      - name: "RHEL 6 x86_64 - LoadBalancer"
        baseurl: "http://ks/kstree/rhel/6/3/x86_64/LoadBalancer/"

    hosts:
      - ip: 192.168.122.171
        hostname: rhel-6-lvs-default-1
      - ip: 192.168.122.172
        hostname: rhel-6-lvs-default-2

    templates:
      autoinst:
        src: autoinstall.d/rhel-6-lvs-ks.cfg

    setup_data:
      - src: data/lvs/Makefile
        dst: Makefile
      - src: data/lvs/setup_nat.sh
        dst: setup_nat.sh
      - src: data/lvs/setup_dr.sh
        dst: setup_dr.sh
    # - src: data/lvs/lvs.cf
    #   dst: lvs.cf

    lvs:
      routers:
        primary: 192.168.155.171
        backup: 192.168.155.172

      rs:
      - hostname: rhel-6-lvs-rs-1
        ip: 192.168.155.181
      - hostname: rhel-6-lvs-rs-2
        ip: 192.168.155.182

      # If NAT or DR mode:
      public:
        ip:
          addr: 192.168.155.170
          network: 192.168.155.0
          maskbit: 24
      # If NAT mode:
      private:
        ip:
          addr: 192.168.122.170
          network: 192.168.122.0
          maskbit: 24

    guests:
      - hostname: &rhel_6_lvs_1_hostname rhel-6-lvs-1
        fqdn: &rhel_6_lvs_1_fqdn rhel-6-lvs-1.m2.local
        ip: &rhel_6_lvs_1_ip 192.168.155.171
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:71"
            ip: *rhel_6_lvs_1_ip
            host: *rhel_6_lvs_1_hostname
            fqdn: *rhel_6_lvs_1_fqdn
            network: service
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:71"
            ip: 192.168.122.171
            host: rhel-6-lvs-default-1
            network: default
            nodns: true

      - hostname: &rhel_6_lvs_2_hostname rhel-6-lvs-2
        fqdn: &rhel_6_lvs_2_fqdn rhel-6-lvs-2.m2.local
        ip: &rhel_6_lvs_2_ip 192.168.155.172
        interfaces:
          - device: eth0  # for service
            mac: "52:54:00:05:01:72"
            ip: *rhel_6_lvs_2_ip
            host: *rhel_6_lvs_2_hostname
            fqdn: *rhel_6_lvs_2_fqdn
            network: service
          - device: eth1  # for heartbeat
            bootproto: static
            mac: "52:54:00:02:01:72"
            ip: 192.168.122.172
            host: rhel-6-lvs-default-2
            network: default
            nodns: true

  - name: rhel-6-proxy
    squid:
      allowed_network: 192.168.155.0/24
      auth:
        username: foo
        password: secret

    templates:
      autoinst:
        src: autoinstall.d/rhel-6-proxy-ks.cfg

    setup_data:
      - src: data/proxy/squid.conf
        dst: squid.conf

    guests:
      - hostname: &rhel_6_proxy_1_hostname rhel-6-proxy-1
        fqdn: &rhel_6_proxy_1_fqdn rhel-6-proxy-1.m2.local
        ip: &rhel_6_proxy_1_ip 192.168.155.191
        interfaces:
          - device: eth0
            mac: "52:54:00:05:01:91"
            ip: *rhel_6_proxy_1_ip
            host: *rhel_6_proxy_1_hostname
            fqdn: *rhel_6_proxy_1_fqdn
            network: service
          - device: eth1
            bootproto: static
            mac: "52:54:00:02:01:91"
            ip: 192.168.122.191
            host: rhel-6-proxy-default-1
            network: default
            nodns: true

  - name: rhevh
    description: RHEL Hypervisor node
    virtinst:
      ram: 2560
      cpu: host
      vcpus: 2
      cdrom: /var/lib/libvirt/images/rhevh-6.3-20121121.0.el6_3.iso
      #TODO: --extra-args requires --local but ...
      extra_args: storage_init=/dev/vda1 BOOTIF=eth0 adminpw=redhat

    templates:
      autoinstall:
        dst: false

    guests:
      - hostname: &rhevh_1_hostname rhevh-1
        fqdn: &rhevh_1_fqdn rhevh-1.m2.local
        ip: &rhevh_1_ip 192.168.155.33
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:33"
            ip: *rhevh_1_ip
            host: *rhevh_1_hostname
            fqdn: *rhevh_1_fqdn
            network: service

  - name: rhevm
    description: RHEV Manager node
    disks:
      - pool: default
        size: 50

    virtinst:
      ram: 2560
      vcpus: 2

    #rhn:
    #  username: foo@m2.local
    #  password: xyzsecret
    #  activationkeys: xxxxxxxxxxxxxxx

    templates:
      autoinst:
        src: autoinstall.d/rhev-manager-ks.cfg

    setup_data:
      - src: data/rhev-manager/Makefile
        dst: Makefile
      - src: data/rhev-manager/answers.txt
        dst: answers.txt

    guests:
      - hostname: &rhevm_1_hostname rhevm-1
        fqdn: &rhevm_1_fqdn rhevm-1.m2.local
        ip: &rhevm_1_ip 192.168.155.31
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:31"
            ip: *rhevm_1_ip
            host: *rhevm_1_hostname
            fqdn: *rhevm_1_fqdn
            network: service

        rhev:
          # If remote:
          # db_host: *fqdn
          # db_remote_pass: xxxxxxxxx
          auth_pass: redhat0123
          db_local_pass: redhat0123
          override_iptables: no
          #dc_type: ISCSI

  - name: rhs
    description: Red Hat Storage node
    ks_repos:
      - name: "RHEL 6 x86_64 - ScalableFileSystem"
        baseurl: "http://ks/kstree/rhel/6/3/x86_64/ScalableFileSystem"

    rhs:
      nodes:
        - rhs-1
        - rhs-2
        - rhs-3
        - rhs-4
      volume: vol01
      brick: /data/brick01

    templates:
      autoinst:
        src: autoinstall.d/glusterfs-ks.cfg

    guests:
      - hostname: &rhs_1_hostname rhs-1
        fqdn: &rhs_1_fqdn rhs-1.m2.local
        ip: &rhs_1_ip 192.168.155.51
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:51"
            ip: *rhs_1_ip
            host: *rhs_1_hostname
            fqdn: *rhs_1_fqdn
            network: service

        disks:
          - pool: default
            size: 5
          - pool: default
            vol: rhs-1-data-1
            size: 1

      - hostname: &rhs_2_hostname rhs-2
        fqdn: &rhs_2_fqdn rhs-2.m2.local
        ip: &rhs_2_ip 192.168.155.52
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:52"
            ip: *rhs_2_ip
            host: *rhs_2_hostname
            fqdn: *rhs_2_fqdn
            network: service

        disks:
          - pool: default
            size: 5
          - pool: default
            vol: rhs-2-data-1
            size: 1

      - hostname: &rhs_3_hostname rhs-3
        fqdn: &rhs_3_fqdn rhs-3.m2.local
        ip: &rhs_3_ip 192.168.155.53
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:53"
            ip: *rhs_3_ip
            host: *rhs_3_hostname
            fqdn: *rhs_3_fqdn
            network: service

        disks:
          - pool: default
            size: 5
          - pool: default
            vol: rhs-3-data-1
            size: 1

      - hostname: &rhs_4_hostname rhs-4
        fqdn: &rhs_4_fqdn rhs-4.m2.local
        ip: &rhs_4_ip 192.168.155.54
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:54"
            ip: *rhs_4_ip
            host: *rhs_4_hostname
            fqdn: *rhs_4_fqdn
            network: service

        disks:
          - pool: default
            size: 5
          - pool: default
            vol: rhs-4-data-1
            size: 1

  - name: sam
    description: RH Subscription Asset Manager server
    virtinst:
      ram: 2048
      vcpus: 2

    templates:
      autoinst:
        src: autoinstall.d/sam-ks.cfg

    guests:
      - hostname: &sam_1_hostname sam-1
        fqdn: &sam_1_fqdn sam-1.m2.local
        ip: &sam_1_ip 192.168.155.15
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:15"
            ip: *sam_1_ip
            host: *sam_1_hostname
            fqdn: *sam_1_fqdn
            network: service

  - name: satellite
    description: RHN Satellite server
    disks:
      - pool: default
        size: 50

    virtinst:
      ram: 2048

    satellite:
      admin:
        email: root@localhost

      ssl:
        org: "M2 Example, Inc."
        unit: "IT Dept."
        city: Shibuya-ku
        state: Tokyo
        country: JP
        password: sslsecret

    #rhn:
    #  username: foo@m2.local
    #  password: xyzsecret

    #proxy:
    #  fqdn: proxy.m2.local
    #  username: proxyuser
    #  username: proxypasswd

    templates:
      autoinst:
        src: autoinstall.d/satellite-ks.cfg

    guests:
      - hostname: &satellite_1_hostname satellite-1
        fqdn: &satellite_1_fqdn satellite-1.m2.local
        ip: &satellite_1_ip 192.168.155.11
        interfaces:
          - device: eth0
            mac: "52:54:00:05:00:11"
            ip: *satellite_1_ip
            host: *satellite_1_hostname
            fqdn: *satellite_1_fqdn
            network: service

# vim:sw=2:ts=2:et:
